# 🌍 Trading Simulation Prototype

ランダム生成された大陸に複数の村が現れ、資源を採集・交易しながら村 → 町 → 都市へと発展していく様子を眺めるシミュレーションプロトタイプです。

## ✨ 概要

- 2D 俯瞰マップ（Phaser + TypeScript）
- ノイズ関数でランダム生成される大陸マップ
- タイルごとに資源（食料 / 木材 / 鉱石）を割り当て
- 村は近隣の資源を収集し、交易で不足を補う
- 交易路は通行量に応じて進化し、使われなくなると衰退・消滅する
- 各村の資源ストックをテキストで可視化

## 🛠 技術スタック

- TypeScript
- Phaser 3
- Vite（開発用）
- GitHub Pages（公開用）

## ⛏ 想定プロジェクト構成

(例)

    .
    ├── index.html
    ├── src/
    │   ├── main.ts        // エントリーポイント（ゲームループ）
    │   ├── map.ts         // マップ生成 & 資源割り当て
    │   ├── village.ts     // 村データ定義 & 成長ロジック
    │   ├── trade.ts       // 交易ロジック
    │   └── render.ts      // 描画ヘルパー（地形・資源・村・道）
    ├── assets/            // ピクセルアートや音声（後で追加）
    └── README.md

## 🚀 ローカルでの起動（例）

1.  開発サーバーを起動

```
npm run dev
```

2.  ビルド（公開用）

```
npm run build
```

3.  （任意）gh-pages でデプロイする場合

```
npm install --save-dev gh-pages
// package.json に `"deploy": "gh-pages -d dist"` を追加してから
npm run build
npm run deploy
```

## ✅ 現在の実装（プロトタイプで実装済み）

- ノイズベースで大陸マップを生成（海・平地・山の分類）
- タイルごとに資源量（food / wood / ore）を割り当て
- 複数の村をランダムに配置（population, storage, settlementLevel を保持）
- MST（最小全域木）で村を選択的に接続 → 各接続に A\* を適用して地形コストを考慮した道を生成
- 道は `usage` と `decay` を持ち、通行で進化・経年で衰退する
- 村は周辺半径から資源を収集し、簡易交易で物資をやり取りする
- 各村横に資源ストックをテキスト表示（毎フレーム `.setText()` で更新）
- 村の収集範囲の可視化（範囲円）

## 🌱 今後の拡張アイデア（優先順の候補）

1. 交易キャラバンを可視化（荷車や点が道を移動）
2. 資源採取のタイル消耗（採り尽くしと回復）
3. 資源需要/供給の複雑化（複数品目の需要曲線）
4. BGM／環境音の導入と昼夜サイクルでの音変化
5. 神の介入 UI（山の隆起・水源の追加など）

## 🧾 実装メモ・注意点

- Phaser の `this.add.text()` は毎フレーム作るとオブジェクトが増え続けパフォーマンスを悪化させます。  
  → 村ごとにテキストオブジェクトを一度作り、更新は `.setText()` を使うこと。
- A\* や MST の計算はマップサイズに応じてコストが上がるため、頻繁に再計算する場合は最適化（経路キャッシュ等）を検討すること。
- リソース可視化は最初は `Graphics` 描画で OK。後でピクセルアートに差し替え可能。

## 📷 デモ / スクリーンショット

スクリーンショットや GIF を追加する場合は `assets/` に画像を置き、README に次のように貼れます：

    ![screenshot](assets/screenshot.png)

（ここでは画像は含めていません。追加したい場合はファイルを置いてパスを更新してください。）

## 📜 ライセンス

MIT License
